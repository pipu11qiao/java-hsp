#关系型数据库


## 数据类型

| 名称 | 类型 | 说明 | 
|---- | ---- |
|INT | 整型 | 4字节整数类型，范围+/-21亿
|BIGINT | 长整型 | 8字节 |
| REAL|浮点型|4字节浮点型 10 38
| DOUBLE | 浮点型 | 8字节
| DECIMAL(M,N)| 高精度小数 
| CHAR(N) | 存储指定长度的字符串,例如 CHAR(100)总是存储100个字符的字符串
| VARCHAR(N) | 存储可变长度的字符串，VARCHAR(100)可以存储0-100字符的字符串
| BOOLEAN
| DATE
| TIME
| DATETIME

选择数据类型的时候，要根据业务规则选择合适的类型，通常来说，BIGINT能满足整数存储的要求
VARCHAR(N)能满足字符串存储的要求

### 主流关系数据库

1. 商用数据库 例如： Oracle,SQL,Server,DB2等；
2. 开源数据库 例如： MySQL,PostgreSQL
3. 桌面数据库 例如： Access
4. 嵌入式数据库 Sqlite

## SQL

结构化查询语言的缩写，用来访问和操作数据库系统。
各个不同的数据库对sql标准都进行了支持，但是也基本都有自己的扩展。
总的来说，sql语言定义了几种操作数据库的能力：

DDL: Data Manipulation Language
DDL允许用户定义数据，也就是创建表、删除表、修改表结构这些操作。通常，DDL由数据库管理员执行

DML： Data Manipulation Language
DML为用户提供添加、删除、更新数据的能力，这些是应用程序对数据库的日常操作

DQL： Data Query Language
DQL允许用户查询数据，这也是数据库最频繁的操作

### 语法特点

SQL 语言不区分大小写
约定： SQL关键字总是大写，以示突出，表名和列名均使用小写

# 关系模型

关系数据库时建立在关系模型上的，而关系模型本质上就是若干个存储数据的二维表，可以把它们看作是很多Excel表

表的每一行称为一个记录 Record,记录是一个逻辑意义上的数据。 表的每一列称为一个字段 Column
通常情况下，字段应该避免为NULL，不允许为NULL可以简化查询条件，加快查询速度，也利于应用程序读取数据后无需判断是否为NULL

关系数据库的表和表之间需要建立"一对多"，"多对一"和"一对一"的关系，这样才能够按照应用程序的逻辑来组织和存储数据。

在关系数据库中，关系是通过主键和外键来维护的。

## 主键

任意两个记录不能重复，通过记录的某个字段能唯一区分出不同的记录，这个字段别成为主键。

不用任何业务字段作为主键

常用来作为ID的类型有

1. 自增整数类型
2. 全局唯一GUID类型

### 联合主键

通过两个或更多的字段设置为主键，这种主键被称为联合主键,不怎么常用

## 外键

一个班级对应多个学生
为了表达一对多的关系，需要再student表中加入一列class_id,让它的值与classes表的某条记录相对应：

### 外键实现

外键并不是通过列名来实现的，而是通过定义外键约束实现的：

```sql
ALTER TABLE students
ADD CONSTRAINT fk_class_id
FOREIGN KEY (class_id)
REFERENCES classes (id);
```
通过外键约束可以保证无法插入无效的数据。即如果classes表不存在id=99的记录，students表就无法插入

由于外键约束会降低数据库的性能，为了追求速度，不设置外键约束，而是紧靠程序自身保证逻辑的正确性。这种情况下 class_id仅仅是一个普通的列。只是起到了外键的作用

### 多对多

一个老师有多个班级，一个班级有多个老师
多对多关系实际上是通过两个一对多关系实现的，即通过一个中间表，关联两个一对多的关系，就形成了多对多的关系：
techer_table
class_table
tacher_class_table

### 一对一

一个大表，进行拆分，将经常使用的和不经常使用的拆分出来。

## 索引

在关系数据库中，如果有上万甚至上亿条数据，想要获得非常快的速度，就要使用索引。

索引是关系数据库中对某一列或多个列的值进行与排序的数据结构。通过使用索引，可以让数据库系统不必扫描整个表，而是直接定位到符合条件的记录。

```sql
ALTER TABLE  students
ADD INDEX idx_score(score)
```

索引的效率取决于用来索引的列的数据的散列情况
索引提高了查询的效率，增加了插入、更新和删除记录的速度。


### 唯一索引

给某列添加一个唯一索引

```sql
ALTER TABLE  students
ADD UNIQUE INDEX uni_name (name)
```

也可以添加唯一约束而不添加索引

```sql
ALTER TABLE students
ADD CONSTRAINT uni_name UNIQUE (name)
```

